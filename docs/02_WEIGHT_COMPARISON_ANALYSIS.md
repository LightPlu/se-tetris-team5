# El-Tetris vs 유전 알고리즘 가중치 비교 분석

## 개요

이 문서는 El-Tetris 알고리즘의 가중치와 유전 알고리즘으로 최적화된 가중치를 비교하고, 각 가중치가 무엇을 의미하는지 상세히 설명합니다.

**El-Tetris**: 단일 플레이어 모드 최적화 (생존 중심)  
**현재 구현**: 대전 모드 최적화 (공격 중심)

---

## 가중치 비교표

### El-Tetris 특징 가중치 비교

| 특징 | El-Tetris (논문) | 현재 구현 (최신) ⭐ | 비율 | 차이점 |
|------|-----------------|-----------------|------|--------|
| **Landing Height** | -4.50 | -7.80 | **1.73배** | 더 큰 패널티 (높이에 더 민감) |
| **EPCM** | 3.42 | 5.58 | **1.63배** | 더 큰 보너스 (줄 삭제 선호) |
| **Row Transitions** | -3.22 | -1.58 | **0.49배** | 더 작은 패널티 (가로 전환에 덜 민감) |
| **Column Transitions** | -9.35 | -1.13 | **0.12배** | **훨씬 작은 패널티** (세로 전환에 덜 민감) |
| **Holes** | -7.90 | -18.80 | **2.38배** | **훨씬 큰 패널티** (구멍에 매우 민감) |
| **Well Sums** | -3.39 | -8.69 | **2.56배** | 더 큰 패널티 (Well에 더 민감) |

### 대전 모드 공격 보너스 (현재 구현만 존재)

| 특징 | 가중치 | 설명 |
|------|--------|------|
| **Attack 2 Lines** | 15.14 | 2줄 삭제 시 공격 보너스 |
| **Attack 3 Lines** | 19.18 | 3줄 삭제 시 공격 보너스 |
| **Attack 4 Lines (Tetris)** | 59.16 | 4줄 삭제 시 공격 보너스 (가장 큰 보너스) |

---

## 각 가중치의 의미와 계산 방법

### 1. Landing Height (착지 높이)

**의미**: 블록이 착지한 높이 (보드 하단부터의 거리)

**El-Tetris 가중치**: -4.50  
**현재 구현 가중치**: -7.80

**계산 방법**:
```java
landingHeight = HEIGHT - blockY; // 블록이 착지한 Y 좌표
score += landingHeight * weightLandingHeight;
```

**왜 음수인가?**
- 높이가 낮을수록 (보드 하단에 가까울수록) 좋음
- 높이가 높을수록 게임 오버 위험이 증가
- 따라서 높이에 비례하여 패널티 부여

**차이점 분석**:
- 현재 구현이 더 큰 패널티 (-7.80 vs -4.50)
- **이유**: 대전 모드에서 높이가 높으면 상대방의 공격 블록을 받았을 때 더 위험
- 높이 관리가 더 중요함

**게임 플레이에 미치는 영향**:
- 높은 가중치: 블록을 가능한 한 낮게 배치하려고 함
- 낮은 가중치: 높이보다 다른 요소(공격 등)에 집중

---

### 2. EPCM (Eroded Piece Cells Metric, 침식된 블록 셀 메트릭)

**의미**: 삭제된 줄 수 × 그 줄을 삭제하는 데 기여한 블록의 셀 수

**El-Tetris 가중치**: 3.42  
**현재 구현 가중치**: 5.58

**계산 방법**:
```java
epcm = linesCleared * usefulBlocks; // usefulBlocks는 삭제에 기여한 블록 셀 수
score += epcm * weightEPCM;
```

**예시**:
- I-block으로 4줄 삭제: `epcm = 4 × 4 = 16`
- 작은 블록으로 1줄 삭제: `epcm = 1 × 2 = 2`
- I-block이 더 높은 EPCM 값을 가짐

**왜 양수인가?**
- 줄을 삭제하는 것은 좋은 행동
- 더 많은 블록이 기여할수록 더 좋음 (효율적인 줄 삭제)
- 따라서 EPCM에 비례하여 보너스 부여

**차이점 분석**:
- 현재 구현이 더 큰 보너스 (5.58 vs 3.42)
- **이유**: 대전 모드에서 줄 삭제는 공격으로 이어지므로 더 중요
- 하지만 차이가 크지 않음 (둘 다 양수, 비슷한 범위)

**게임 플레이에 미치는 영향**:
- 높은 가중치: 줄 삭제를 더 선호, 특히 I-block 같은 큰 블록 활용
- 낮은 가중치: 줄 삭제보다 보드 상태 관리에 집중

---

### 3. Row Transitions (가로 전환)

**의미**: 각 행에서 빈 셀과 채워진 셀 사이의 전환 횟수

**El-Tetris 가중치**: -3.22  
**현재 구현 가중치**: -1.58

**계산 방법**:
```java
// 각 행을 왼쪽에서 오른쪽으로 스캔
// 빈 셀(0) ↔ 채워진 셀(1) 전환 횟수 계산
// 경계도 전환으로 간주 (왼쪽 경계는 채워져 있다고 가정)
rowTransitions = countRowTransitions(board);
score += rowTransitions * weightRowTransitions;
```

**예시**:
```
행: [1][1][0][0][1][0][1][1][0][1]
전환: 1→1(0) → 1→0(1) → 0→0(0) → 0→1(2) → 1→0(3) → 0→1(4) → 1→1(0) → 1→0(5) → 0→1(6)
총 전환: 6회
```

**왜 음수인가?**
- 전환이 적을수록 (행이 더 단단하게 채워질수록) 좋음
- 전환이 많으면 보드가 불안정하고 다음 블록 배치가 어려움
- 따라서 전환 횟수에 비례하여 패널티 부여

**차이점 분석**:
- 현재 구현이 더 작은 패널티 (-1.58 vs -3.22)
- **이유**: 대전 모드에서는 공격이 우선이므로, 보드의 완벽한 정렬보다 공격 기회를 중시
- 가로 전환에 덜 민감하게 반응

**게임 플레이에 미치는 영향**:
- 높은 가중치: 행을 완벽하게 채우려고 함, 불규칙한 배치 회피
- 낮은 가중치: 약간의 불규칙함을 허용하고 공격 기회를 우선

---

### 4. Column Transitions (세로 전환)

**의미**: 각 열에서 빈 셀과 채워진 셀 사이의 전환 횟수

**El-Tetris 가중치**: -9.35  
**현재 구현 가중치**: -1.13

**계산 방법**:
```java
// 각 열을 위에서 아래로 스캔
// 빈 셀(0) ↔ 채워진 셀(1) 전환 횟수 계산
columnTransitions = countColumnTransitions(board);
score += columnTransitions * weightColumnTransitions;
```

**예시**:
```
열: [0][0][1][1][1][0][0][1][1][0]
전환: 0→0(0) → 0→1(1) → 1→1(0) → 1→0(2) → 0→0(0) → 0→1(3)
총 전환: 3회
```

**왜 음수인가?**
- 전환이 적을수록 (열이 더 단단하게 채워질수록) 좋음
- 전환이 많으면 보드가 불안정하고 구멍이 생기기 쉬움
- 따라서 전환 횟수에 비례하여 패널티 부여

**차이점 분석**:
- 현재 구현이 훨씬 작은 패널티 (-1.13 vs -9.35)
- **이유**: 대전 모드에서는 공격이 우선이므로, 완벽한 열 정렬보다 공격 기회를 중시
- 세로 전환에 덜 민감하게 반응

**게임 플레이에 미치는 영향**:
- 높은 가중치: 열을 완벽하게 채우려고 함, 구멍 회피에 집중
- 낮은 가중치: 약간의 불규칙함을 허용하고 공격 기회를 우선

---

### 5. Number of Holes (구멍 개수)

**의미**: 위에 블록이 있는 빈 셀의 개수 (구멍)

**El-Tetris 가중치**: -7.90  
**현재 구현 가중치**: -18.80

**계산 방법**:
```java
// 각 열을 위에서 아래로 스캔
// 블록을 만난 후 빈 셀이 나오면 구멍으로 간주
holes = countHoles(board);
score += holes * weightHoles;
```

**예시**:
```
열: [0][0][1][1][0][1][1][1]
     ↑  ↑  ↑  ↑  ↑  ↑  ↑  ↑
구멍: X  X  O  O  O  O  O  O
     (블록 위에 빈 셀 = 구멍)
총 구멍: 5개
```

**왜 음수인가?**
- 구멍이 적을수록 좋음
- 구멍이 많으면 블록을 채우기 어렵고 게임 오버 위험 증가
- 따라서 구멍 개수에 비례하여 패널티 부여

**차이점 분석**:
- 현재 구현이 **훨씬 큰 패널티** (-18.80 vs -7.90, 약 2.38배)
- **이유**: 대전 모드에서 구멍이 있으면 상대방의 공격을 받았을 때 더 위험
- 구멍 관리가 생존에 매우 중요
- 따라서 구멍에 매우 민감하게 반응

**게임 플레이에 미치는 영향**:
- 높은 가중치: 구멍을 매우 회피, 완벽한 보드 관리
- 낮은 가중치: 약간의 구멍을 허용하고 공격 기회를 우선

---

### 6. Well Sums (Well 깊이 합)

**의미**: Well(좌우가 모두 채워진 빈 공간)의 깊이 합

**El-Tetris 가중치**: -3.39  
**현재 구현 가중치**: -8.69

**계산 방법**:
```java
// Well: 좌우가 모두 채워진 연속된 빈 셀
// 각 Well의 깊이를 계산하고 합산
wellSums = calculateWellSums(board);
score += wellSums * weightWellSums;
```

**예시**:
```
보드 상태:
[1][1][0][0][0][1][1]
[1][1][0][0][0][1][1]
[1][1][0][0][0][1][1]
     ↑  ↑  ↑
   Well (깊이 3)

wellSums = 3
```

**왜 음수인가?**
- El-Tetris에서는 Well을 만들면 I-block을 위한 공간이 생김
- 하지만 Well 자체는 빈 공간이므로 패널티
- Well을 만들되 너무 깊지 않게 유지하는 것이 중요

**차이점 분석**:
- 현재 구현이 더 큰 패널티 (-8.69 vs -3.39)
- **이유**: 대전 모드에서는 Well을 만드는 것이 공격 기회를 놓칠 수 있음
- Well보다는 즉시 공격할 수 있는 배치를 선호
- Well에 더 민감하게 반응하여 회피

**게임 플레이에 미치는 영향**:
- 높은 가중치: Well을 매우 회피, 즉시 공격 가능한 배치 선호
- 낮은 가중치: Well을 허용하고 I-block을 기다리는 전략 가능

---

### 7. Attack 2 Lines (2줄 삭제 공격 보너스)

**의미**: 2줄을 삭제했을 때의 공격 보너스 (대전 모드 전용)

**El-Tetris**: 존재하지 않음 (단일 플레이어 모드)  
**현재 구현 가중치**: 15.14

**계산 방법**:
```java
if (linesCleared == 2) {
    score += weightAttack2Lines;
}
```

**왜 양수인가?**
- 2줄 삭제 시 상대방에게 공격 블록 전송
- 대전 모드에서 공격은 승리의 핵심
- 따라서 2줄 삭제에 보너스 부여

**게임 플레이에 미치는 영향**:
- 높은 가중치: 2줄 삭제를 적극적으로 시도
- 낮은 가중치: 2줄 삭제보다 4줄 삭제(Tetris)를 선호

---

### 8. Attack 3 Lines (3줄 삭제 공격 보너스)

**의미**: 3줄을 삭제했을 때의 공격 보너스 (대전 모드 전용)

**El-Tetris**: 존재하지 않음 (단일 플레이어 모드)  
**현재 구현 가중치**: 19.18

**계산 방법**:
```java
if (linesCleared == 3) {
    score += weightAttack3Lines;
}
```

**차이점 분석**:
- 3줄 삭제 보너스가 2줄보다 큼 (19.18 vs 15.14)
- **이유**: 3줄 삭제는 드물고, 2줄 삭제가 더 자주 발생
- 하지만 4줄 삭제(Tetris)가 가장 큰 보너스를 받음

**게임 플레이에 미치는 영향**:
- 중간 수준의 보너스로, 3줄 삭제도 유용하지만 Tetris보다는 낮음

---

### 9. Attack 4 Lines (Tetris, 4줄 삭제 공격 보너스)

**의미**: 4줄을 삭제했을 때의 공격 보너스 (대전 모드 전용, Tetris)

**El-Tetris**: Well Sums = -3.39 (Well을 만드는 것에 대한 패널티)  
**현재 구현 가중치**: 59.16

**계산 방법**:
```java
if (linesCleared == 4) {
    score += weightAttack4Lines; // Tetris 보너스
}
```

**차이점 분석**:
- **완전히 다른 개념!**
- El-Tetris: Well Sums는 Well을 만드는 것에 대한 패널티 (음수)
- 현재 구현: Tetris는 4줄 삭제에 대한 보너스 (양수, 매우 큰 값)
- **부호가 반대이고 의미도 완전히 다름**

**왜 가장 큰 보너스인가?**
- 4줄 삭제(Tetris)는 가장 강력한 공격
- 상대방에게 큰 피해를 입힘
- 대전 모드에서 승리의 핵심 전략

**게임 플레이에 미치는 영향**:
- 매우 높은 가중치: Tetris를 적극적으로 시도
- I-block을 모아서 4줄 삭제를 노림
- 1-2줄 삭제보다 4줄 삭제를 선호

---

## 핵심 차이점 요약

### 1. **Well Sums vs Tetris (Attack 4 Lines)** ⚠️ 가장 큰 차이

**El-Tetris:**
- Well Sums = -3.39 (음수)
- Well Building 전략: I-block을 위한 구멍(Well)을 만드는 것에 대한 패널티
- Well이 있으면 패널티 (Well Sums는 음수)

**현재 구현:**
- Attack 4 Lines (Tetris) = 59.16 (양수, 매우 큰 값)
- 4줄 삭제 시 큰 보너스
- 대전 모드에서 공격이 중요하므로 Tetris에 큰 가중치

**완전히 다른 개념!**
- El-Tetris: Well을 만드는 것에 대한 패널티 (생존 중심)
- 현재 구현: Tetris를 시도하는 것에 대한 보너스 (공격 중심)

### 2. **Holes 가중치가 작은 이유**

**El-Tetris:** -7.90  
**현재 구현:** -18.80 (약 2.38배)

**이유:**
- 대전 모드에서 구멍이 있으면 상대방의 공격을 받았을 때 더 위험
- 구멍 관리가 생존에 매우 중요
- 따라서 구멍에 대한 패널티를 크게 설정하여 적극적으로 회피

### 3. **Landing Height가 큰 이유**

**El-Tetris:** -4.50  
**현재 구현:** -7.80 (약 1.73배)

**이유:**
- 대전 모드에서 높이가 높으면 상대방의 공격 블록을 받았을 때 더 위험
- 높이 관리가 더 중요함

### 4. **Row/Column Transitions가 작은 이유**

**El-Tetris:**
- Row Transitions: -3.22
- Column Transitions: -9.35

**현재 구현:**
- Row Transitions: -1.58 (약 0.49배)
- Column Transitions: -1.13 (약 0.12배)

**이유:**
- 대전 모드에서는 완벽한 보드 정렬보다 공격 기회를 중시
- 약간의 불규칙함을 허용하고 공격에 집중

### 5. **Well Sums가 큰 이유**

**El-Tetris:** -3.39  
**현재 구현:** -8.69 (약 2.56배)

**이유:**
- 대전 모드에서는 Well을 만드는 것이 공격 기회를 놓칠 수 있음
- Well보다는 즉시 공격할 수 있는 배치를 선호
- Well에 더 민감하게 반응하여 회피

---

## 평가 함수 비교

### El-Tetris 평가 함수 (논문 기준)
```
Score = -4.50 × Landing Height
      + 3.42 × Eroded Piece Cells Metric
      - 3.22 × Row Transitions
      - 9.35 × Column Transitions
      - 7.90 × Number of Holes
      - 3.39 × Well Sums
```

**목표**: 단일 플레이어 모드에서 최대한 오래 생존 (생존 중심)

### 현재 구현 평가 함수 (최신 가중치)
```java
Score = -7.80 × Landing Height
      + 5.58 × EPCM (Eroded Piece Cells Metric)
      - 1.58 × Row Transitions
      - 1.13 × Column Transitions
      - 18.80 × Number of Holes
      - 8.69 × Well Sums
      + (linesCleared == 2 ? 15.14 : 0)
      + (linesCleared == 3 ? 19.18 : 0)
      + (linesCleared == 4 ? 59.16 : 0)  // Tetris 보너스
```

**목표**: 대전 모드에서 상대방을 먼저 게임 오버시키기 (공격 중심)

### 주요 차이점

1. **Landing Height 사용**
   - El-Tetris: Landing Height (블록이 착지한 높이)
   - 현재 구현: Landing Height (동일)
   - **차이 없음**: 둘 다 블록별로 계산

2. **EPCM 사용**
   - El-Tetris: Eroded Piece Cells Metric = 삭제된 줄 수 × 유용한 블록 수
   - 현재 구현: EPCM (동일)
   - **차이 없음**: 둘 다 블록의 기여도를 고려

3. **Well Sums vs Attack 보너스**
   - El-Tetris: Well Sums (Well의 깊이 합, 음수) - Well을 만드는 것에 대한 패널티
   - 현재 구현: Attack 보너스 (2/3/4줄 삭제 시 보너스, 양수) - 공격에 대한 보너스
   - **완전히 다른 개념!** Well Sums는 생존 전략, Attack 보너스는 공격 전략

4. **대전 모드 전용 특징**
   - 현재 구현만 존재: Attack 2/3/4 Lines 보너스
   - El-Tetris에는 없음 (단일 플레이어 모드)

---

## 전략적 차이점

### El-Tetris 전략 (단일 플레이어 모드)

**목표**: 최대한 오래 생존하며 많은 줄을 삭제

**특징**:
1. **Well Building**: I-block을 위한 Well을 만드는 전략
2. **완벽한 보드 관리**: 구멍, 전환 최소화
3. **높이 관리**: 높이를 낮게 유지
4. **생존 우선**: 공격보다 생존에 집중

**가중치 특징**:
- Holes: 큰 패널티 (-7.90) → 구멍 회피
- Well Sums: 작은 패널티 (-3.39) → Well 허용
- 공격 보너스 없음 → 공격보다 생존

### 현재 구현 전략 (대전 모드)

**목표**: 상대방을 먼저 게임 오버시키기

**특징**:
1. **공격 우선**: 2줄 이상 삭제로 상대방 공격
2. **Tetris 선호**: 4줄 삭제에 큰 보너스
3. **유연한 보드 관리**: 약간의 구멍/불규칙함 허용
4. **공격 우선**: 생존보다 공격에 집중

**가중치 특징**:
- Holes: 매우 큰 패널티 (-18.80) → 구멍 적극 회피
- Well Sums: 큰 패널티 (-8.69) → Well 회피
- Attack 보너스: 매우 큰 보너스 (59.16 for Tetris) → 공격 장려

---

## 왜 가중치가 다른가?

### 1. **게임 모드의 차이**

**El-Tetris (단일 플레이어)**:
- 목표: 최대한 오래 생존
- 상대방 없음 → 공격 불필요
- 생존이 최우선

**현재 구현 (대전 모드)**:
- 목표: 상대방을 먼저 게임 오버
- 상대방 있음 → 공격 필수
- 공격이 최우선

### 2. **평가 기준의 차이**

**El-Tetris**:
- 생존 시간
- 줄 삭제 수
- 보드 상태 (구멍, 전환 최소화)

**현재 구현**:
- 승리율 (가장 중요)
- 공격 효율 (2/3/4줄 삭제)
- 생존 능력 (보조)

### 3. **전략의 차이**

**El-Tetris**:
- Well Building으로 I-block 대기
- 완벽한 보드 관리
- 장기 생존 전략

**현재 구현**:
- 즉시 공격 가능한 배치 선호
- Well 회피 (공격 기회 놓침)
- 단기 공격 전략

---

## 결론

### 가중치 차이는 정상입니다

1. **게임 모드 차이**: 단일 플레이어 vs 대전 모드
2. **목표 차이**: 생존 vs 공격
3. **전략 차이**: Well Building vs 즉시 공격

### El-Tetris 가중치를 그대로 사용하면?

**대전 모드에서 성능이 떨어질 수 있습니다:**
- 공격 보너스가 없어서 공격을 적극적으로 하지 않음
- Well Building 전략이 대전 모드에 부적합
- 상대방보다 느리게 공격하여 패배할 가능성 높음

### 현재 구현의 가중치가 적합한 이유

1. **공격 중심**: Attack 보너스로 공격 장려
2. **유연한 보드 관리**: 약간의 구멍/불규칙함 허용
3. **Well 회피**: 즉시 공격 가능한 배치 선호
4. **대전 모드 최적화**: 승리를 위한 전략

**대전 모드에서는 공격이 생존보다 중요하므로, 현재 구현의 가중치가 더 적합합니다.**

